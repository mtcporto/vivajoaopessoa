<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Qualidade dos mares</title>
    <link rel="icon" href="favicon.ico">
  
    <!-- Estilos -->
    <link rel="stylesheet" href="template.css">
  
    <!-- Tailwind CSS (CDN) -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  
    <!-- Font Awesome (CDN) -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
  
    <!-- Luxon (CDN) -->
    <script src="https://cdn.jsdelivr.net/npm/luxon@2.0.2/build/global/luxon.min.js"></script>
  
    <!-- Google Fonts (CDN) -->
    <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet">
  <link rel="icon" href="favicon.ico">
  <style>
       /* Estilos adicionais podem ser adicionados aqui */
    /* Estilos básicos */
    body {
        font-family: Arial, sans-serif;
        font-size: 16px;
        line-height: 1.5;
        margin: 0;
        padding: 0;
      }
  
      .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 20px;
      }
  
      h1, h2, h3 {
        margin-top: 0;
      }
  
      /* Estilos para o modo claro */
      body {
        background-color: #f8f8f8;
        color: #333;
      }
  
      .container {
        background-color: #fff;
        box-shadow: 0 0 5px rgba(0, 0, 0, 0.1);
      }
  
      header {
        position: relative;
        background-color: #333;
        color: #f8f8f8;
        padding: 10px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }
  
      .dark-mode-toggle {
        background-color: transparent;
        border: none;
        cursor: pointer;
        color: #f8f8f8;
        font-size: 24px;
      }
  
      /* Estilos para o modo escuro */
      body.dark {
        background-color: #333;
        color: #f8f8f8;
      }
  
      .container.dark {
        background-color: #444;
        box-shadow: 0 0 5px rgba(255, 255, 255, 0.1);
      }
      .fa-sun {
        color: yellow;
      }


  
      /* Dark Mode */
      .dark {
        background-color: #1f2937;
        color: #f8fafc;
      }
  
      .dark th,
      .dark td {
        border-color: #374151;
      }
  
      .dark .bg-gray-100 {
        background-color: #4b5563;
      }
  </style>
</head>
<body>
  <header>
    <div class="mx-auto flex justify-between items-center">
      <h1 class="text-3xl font-bold" style="font-family: 'Lobster', cursive;">Qualidade dos mares</h1>
    </div>
    <div>
      <p id="dateTime" class="mb-4"></p>
    </div>
    <div class="dark-mode-container">
      <span id="darkModeToggle" class="dark-mode-toggle"><i class="fas fa-moon"></i></span>
    </div>
  </header>
  <div class="container">
    <h1 class="text-2xl font-bold mb-4">Tabela de Qualidade da Água</h1>
    <span id="intro-text" style="margin-bottom: 50px;"></span><br>

    <strong>Período de Amostragem: </strong><span id="periodo" tyle="margin-top: 50px;"></span><br>
    <strong>Classificação válida até a emissão do próximo relatório, em </strong><span id="validade" style="margin-bottom: 10px;"></span><br>
    
    <!-- Filtro -->
    <select id="filter" style="margin-bottom: 10px;">
      <option value="Imprópria" selected>Impróprias</option>
      <option value="Própria">Próprias</option>
    </select>
    
    <table style="margin-top: 10px;" class="min-w-full bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700">
      <thead>
        <tr>
          <th class="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Município</th>
          <th class="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Praia</th>
          <th class="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Estação</th>
          <th class="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Local</th>
          <th class="px-6 py-3 bg-gray-100 dark:bg-gray-700 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase tracking-wider">Qualidade</th>
        </tr>
      </thead>
      <tbody id="table-body"></tbody>
    </table>
    <!-- Fonte -->
<p style="margin-top: 10px;">Fonte: <a href="https://sudema.pb.gov.br/qualidade-do-ambiente/qualidade-dos-mares" target="_blank">SUDEMA (Superintendência de Administração do Meio Ambiente)</a></p>

    <div class="flex items-center justify-center mt-4">
      <div class="bg-red-100 border-l-4 border-red-500 text-red-700 p-4" role="alert">
        <p class="font-bold">Alerta!</p>
        <p class="text-sm">Essas praias apresentam condições desfavoráveis em relação à qualidade da água, indicando que não são adequadas para atividades de banho. É importante respeitar essas recomendações para preservar a saúde e segurança dos banhistas. A Sudema continua monitorando essas praias e atualizando as informações para garantir a conscientização e proteção dos frequentadores.</p>
      </div>
    </div>
    <div class="flex items-center justify-center mt-4">
      <div class="bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4" role="alert">
        <p class="font-bold">Atenção!</p>
        <p class="text-sm">A verificação da qualidade da água de uma praia é realizada por meio de análises laboratoriais que avaliam a presença de indicadores microbiológicos, como coliformes fecais, que podem indicar a contaminação por agentes patogênicos prejudiciais à saúde humana.</p>
      </div>
    </div>
  </div>



  <script>
    // Lógica para alternar o modo claro e escuro
    const darkModeToggle = document.getElementById('darkModeToggle');
    const darkModeIcon = document.querySelector('#darkModeToggle i');
  
    darkModeToggle.addEventListener('click', function() {
      document.body.classList.toggle('dark');
      document.getElementById('content').classList.toggle('dark');
  
      // Alterna o ícone do botão de alternância de modo escuro
      if (document.body.classList.contains('dark')) {
        darkModeIcon.classList.remove('fa-moon');
        darkModeIcon.classList.add('fa-sun');
      } else {
        darkModeIcon.classList.remove('fa-sun');
        darkModeIcon.classList.add('fa-moon');
      }
    });
  
    // Obtém o elemento onde a data e hora serão exibidas
    const dateTimeElement = document.getElementById('dateTime');
  
    // Função para atualizar a data e hora
    function updateDateTime() {
      // Obtém a data e hora atual usando o Luxon
      const now = luxon.DateTime.local();
  
      // Formata a data e hora
      const formattedDateTime = now.toFormat('dd MMM HH:mm');
  
      // Exibe a data e hora formatada no elemento
      dateTimeElement.textContent = formattedDateTime;
    }
  
    // Atualiza a data e hora a cada segundo
    setInterval(updateDateTime, 1000);
  
    const PROXY_URL = 'https://cors-anywhere.herokuapp.com/';
  
    fetch(PROXY_URL + 'https://sudema.pb.gov.br/qualidade-do-ambiente/qualidade-dos-mares')
      .then(response => response.text())
      .then(html => {
        const parser = new DOMParser();
        const doc = parser.parseFromString(html, 'text/html');
  
        // Extrai os dados que você precisa do documento HTML
        const periodoRegex = /Período de Amostragem: (.*)/;
        const validadeRegex = /Classificação válida até a emissão do próximo relatório, em (.*)/;
        const municipios = ['Mataraca', 'Baia da Traição', 'Rio Tinto', 'Lucena', 'Cabedelo', 'João Pessoa', 'Conde', 'Pitimbú'];
  
        const periodoMatch = doc.body.textContent.match(periodoRegex);
        const validadeMatch = doc.body.textContent.match(validadeRegex);
  
        const periodo = periodoMatch ? periodoMatch[1] : '';
        const validade = validadeMatch ? validadeMatch[1] : '';
  
        const tabelas = doc.querySelectorAll('table.plain');
  
        tabelas.forEach((tabela, index) => {
          const municipio = municipios[index];
  
          // Remove the header row from the scraped table
          tabela.deleteRow(0);
  
          // Para cada linha na tabela, adicione uma nova célula no início com o nome do município
          for (let i = 0; i < tabela.rows.length; i++) {
            const row = tabela.rows[i];
            const cell = row.insertCell(0);
            cell.textContent = municipio;
          }
  
          // Atualiza a sua página com os dados raspados
          if (document.getElementById('periodo')) {
            document.getElementById('periodo').textContent = periodo;
          }
          if (document.getElementById('validade')) {
            document.getElementById('validade').textContent = validade;
          }
          if (document.getElementById('table-body')) {
            // Append the rows of the scraped table to the existing table
            while (tabela.rows.length > 0) {
              document.getElementById('table-body').appendChild(tabela.rows[0]);
            }
          }
        });
         // Adiciona um ouvinte de evento para o filtro
  document.getElementById('filter').addEventListener('change', function() {
    const filter = this.value;

    // Obtém todas as linhas da tabela
    const rows = document.querySelectorAll('#table-body tr');

    // Itera sobre cada linha
    rows.forEach(row => {
      // Obtém a última célula da linha (Qualidade)
      const cell = row.lastElementChild;

      // Verifica se a qualidade corresponde ao filtro
      if (cell.textContent.trim() === filter) {
        // Se corresponder, mostra a linha
        row.style.display = '';
      } else {
        // Se não corresponder, oculta a linha
        row.style.display = 'none';
      }
    });
  });

  // Dispara o evento de alteração no filtro para aplicar o filtro inicial
  document.getElementById('filter').dispatchEvent(new Event('change'));

   // Adiciona um ouvinte de evento para o filtro
   document.getElementById('filter').addEventListener('change', function() {
    const filter = this.value;

    // Obtém todas as linhas da tabela
    const rows = document.querySelectorAll('#table-body tr');

    // Conta as praias
    let totalPraias = 0;
    let praiasImproprias = 0;

    // Itera sobre cada linha
    rows.forEach(row => {
      // Obtém a última célula da linha (Qualidade)
      const cell = row.lastElementChild;

      // Verifica se a qualidade corresponde ao filtro
      if (cell.textContent.trim() === filter) {
        // Se corresponder, mostra a linha
        row.style.display = '';
        praiasImproprias++;
      } else {
        // Se não corresponder, oculta a linha
      }

      totalPraias++;
    });

    // Atualiza o texto no início da página
    document.getElementById('intro-text').textContent = `Das ${totalPraias} praias monitoradas pela Sudema (Superintendência de Administração do Meio Ambiente), ${praiasImproprias} encontram-se impróprias para banho:`;
  });

  // Dispara o evento de alteração no filtro para aplicar o filtro inicial
  document.getElementById('filter').dispatchEvent(new Event('change'));
      })
      .catch(error => {
        console.error('Ocorreu um erro ao obter os dados:', error);
      });
  </script>
  
  
  
  
  
  
  
</body>
</html>
