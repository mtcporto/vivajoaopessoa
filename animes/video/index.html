<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title id="title"></title>
    <style>
        body {
            padding-bottom: 20px;
            font-family: Arial, sans-serif;
        }
        .header {
            background-color: black;
            color: white;
            padding: 10px 0;
            text-align: center;
            margin-bottom: 20px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/@webtor/embed-sdk-js/dist/index.min.js" charset="utf-8" async></script>
</head>
<body>
    <div id="header" class="header"></div>
    <div id="player" class="webtor" />
    <h2 id="resolution"></h2>
    <h2 id="subtitles"></h2>
    <!-- <h2 id="video-title"></h2> -->
    <script>
        // Extrai as informações da URL
        var urlParams = new URLSearchParams(window.location.search);
        var title = decodeURIComponent(urlParams.get('title'));
        var episode = decodeURIComponent(urlParams.get('episode'));
        var magnet = decodeURIComponent(urlParams.get('magnet'));

        // Atualiza o título da página, do vídeo e do cabeçalho
        document.getElementById('title').textContent = title + ' - Episódio ' + episode;
        document.getElementById('header').textContent = title + ' - Episódio ' + episode;
        // document.getElementById('video-title').textContent = title + ' - Episódio ' + episode;

        // Extrai a resolução do título
        var resolution = title.match(/\b(480p|720p|1080p)\b/);
        if (resolution) {
            document.getElementById('resolution').textContent = 'Resolução: ' + resolution[0];
        }

        // Verifica se a legenda em inglês está disponível
        // var subtitles = title.match(/\[us\]/);
        // if (subtitles) {
        //     document.getElementById('subtitles').textContent = 'Legendas em inglês disponíveis';
        // } else {
        //     document.getElementById('subtitles').textContent = 'Legendas em inglês não disponíveis';
        // }

        // Configura o player de vídeo
        window.webtor = window.webtor || [];
        window.webtor.push({
            id: 'player',
            magnet: magnet,
            title: title + ' - Episódio ' + episode,
            on: function(e) {
                if (e.name == window.webtor.TORRENT_FETCHED) {
                    console.log('Torrent fetched!', e.data);
                }
                if (e.name == window.webtor.TORRENT_ERROR) {
                    console.log('Torrent error!');
                }
            },
            // subtitles: [
            //     {
            //         srclang: '[us]',
            //         label: 'English',
            //         src: '',
            //         default: true,
            //     }
            // ],
            lang: 'en',
            i18n: {
                en: {
                    common: {
                        "prepare to play": "Preparing Video Stream... Please Wait...",
                    },
                    stat: {
                        "seeding": "Seeding",
                        "waiting": "Client initialization",
                        "waiting for peers": "Waiting for peers",
                        "from": "from",
                    },
                },
            },
        });
    </script>
</body>
</html>
